<!DOCTYPE html>
<html>
<head>
    <style>
        #chat-log {
            border: 1px solid #000;
            padding: 10px;
            height: 300px;
            overflow-y: auto;
            margin-bottom: 10px;
        }
    
        #chat-form {
            display: flex;
            border: 1px solid #000;
            padding: 10px;
        }
    
        #message-input {
            flex-grow: 1;
            margin-right: 10px;
        }
    
        #chat-form button {
            flex-shrink: 0;
        }
    </style>
</head>
<body>
    <!-- This is where the chat log will be displayed -->
<div id="chat-log"></div>

<form id="chat-form">
    <input id="message-input" type="text" />
    <input type="file" id="image-input" accept="image/*">
    <button type="submit">Send</button>
</form>

<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js">
    
        // Add an event listener to the form's submit event
    document.getElementById('chat-form').addEventListener('submit', async function(event) {
        // Prevent the form from being submitted in the default way
        event.preventDefault();

        // Get the user's message from the input field
        var message = document.getElementById('message-input').value;

        // Clear the input field
        document.getElementById('message-input').value = '';

        // Get the selected file from the file input field
        var file = document.getElementById('image-input').files[0];

        if (file) {
            // Read the file as a data URL
            var reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onloadend = async function() {
                var base64data = reader.result;

                // Send the image to the Segment Anything Model
                try {
                    const response = await axios.post('https://api.segmind.com/v1/sam-img2img', {
                        image: base64data,
                    }, { 
                        headers: { 'x-api-key': 'SG_098e9ec2f3930c89' } 
                    });

                    var segmentData = response.data;
                    console.log(segmentData);
                } catch (error) {
                    console.error(error);
                }

                /*var segmentResponse = await fetch('https://api.segmind.com/v1/sam-img2img', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'x-api-key': 'SG_098e9ec2f3930c89', // replace 'your-api-key' with your actual API key
                    },
                    body: JSON.stringify({
                        image: base64data,
                    }),
                });

                // Parse the response from the Segment Anything Model
                var segmentData = await segmentResponse.json();
                console.log(segmentData);

                // Send the response from the Segment Anything Model to LLAMA2 for analysis
                var llamaResponse = await fetch('https://your-llama2-endpoint', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Ocp-Apim-Subscription-Key': 'your-api-key', // replace 'your-api-key' with your actual API key
                    },
                    body: JSON.stringify({
                        message: segmentData,
                    }),
                });

                // Parse the response from LLAMA2
                var llamaData = await llamaResponse.json();

                // Append the response from LLAMA2 to the chat log
                var chatLog = document.getElementById('chat-log');
                var botMessage = document.createElement('p');
                botMessage.textContent = 'LLM: ' + llamaData.message;
                chatLog.appendChild(botMessage);*/
            };
        }

        // If there's a text message, send it to LLAMA2 for analysis
        if (message) {
            var llamaResponse = await fetch('https://your-llama2-endpoint', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Ocp-Apim-Subscription-Key': 'your-api-key', // replace 'your-api-key' with your actual API key
                },
                body: JSON.stringify({
                    message: message,
                }),
            });

            // Parse the response from LLAMA2
            var llamaData = await llamaResponse.json();

            // Append the response from LLAMA2 to the chat log
            var chatLog = document.getElementById('chat-log');
            var botMessage = document.createElement('p');
            botMessage.textContent = 'LLM: ' + llamaData.message;
            chatLog.appendChild(botMessage);
        }
    });
</script>
</body>
</html>